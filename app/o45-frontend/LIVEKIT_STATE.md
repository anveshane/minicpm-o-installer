# LiveKit çŠ¶æ€åˆ‡æ¢è¯´æ˜ï¼ˆæµ‹è¯•ç‰ˆï¼‰

é¢å‘æµ‹è¯•åŒå­¦ï¼šåªæŒ‰æ—¶é—´çº¿çœ‹æ§åˆ¶å°æ—¥å¿—å³å¯åˆ¤æ–­æ˜¯å¦â€œå‰ç«¯åˆ‡æ¢æœ‰è¯¯â€æˆ–â€œåç«¯æ ‡è®°é”™å‘/æ¼å‘â€ã€‚

## æ—¶é—´çº¿ï¼ˆæ¨¡å‹åˆå§‹åŒ– â†’ è¿æ¥ä¸­ â†’ è†å¬ä¸­ â†’ æ€è€ƒä¸­ â†’ å›ç­”ä¸­ â†’ å†æ¬¡è†å¬ï¼‰

### 1) æ¨¡å‹åˆå§‹åŒ–ï¼ˆinitializingï¼‰

å‰ç«¯åŠ å…¥ LiveKit æˆ¿é—´åï¼ŒçŠ¶æ€è¿›å…¥ `initializing`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `=== LiveKit è¿æ¥é…ç½® ===`ï¼ˆå¼€å§‹è¿æ¥ï¼‰
- `=== è¿æ¥æˆåŠŸçŠ¶æ€ ===` / `âœ… state.connected å·²è®¾ç½®ä¸º true`ï¼ˆè¿æ¥æˆåŠŸï¼‰
- `ğŸ‰ æ”¶åˆ°æ¨¡å‹åˆå§‹åŒ–æˆåŠŸä¿¡å·`ï¼ˆåç«¯è¿”å› `<state><model_init_success>`ï¼‰


### 2) è¿æ¥ä¸­ï¼ˆconnectingï¼‰

å‰ç«¯æ”¶åˆ°åç«¯è¿”å›<state><model_init_success>åï¼ŒçŠ¶æ€å˜æˆè¿æ¥ä¸­ã€‚

### 3) è†å¬ä¸­ï¼ˆlisteningï¼‰

æ”¶åˆ° `<state><model_init_success>` åï¼Œå‰ç«¯ä¼šå‘é€ init ä¿¡æ¯ï¼›åç«¯è¿”å› `<state><session_init>` åè¿›å…¥ `listening`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `ğŸ‰ æ”¶åˆ°æ¨¡å‹åˆå§‹åŒ–æˆåŠŸä¿¡å·`
- `ğŸ“¤ å‘é€åˆå§‹åŒ–é…ç½®:`ï¼ˆå‰ç«¯å‘é€ init ä¿¡æ¯ï¼‰
- `ğŸ”„ æ”¶åˆ° session_initï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º listening`

åˆ¤æ–­è¦ç‚¹ï¼š
- æœ‰ `model_init_success` ä½†æ²¡æœ‰ `session_init`ï¼šåç«¯æœªå‘æˆ–æ¼å‘ã€‚

### 4) æ€è€ƒä¸­ï¼ˆthinkingï¼‰

ç”¨æˆ·è¯´å®Œè¯åï¼Œåç«¯å‘ `<state><vad_end>`ï¼Œå‰ç«¯åˆ‡ä¸º `thinking`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `ğŸ¤” æ”¶åˆ° vad_endï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º thinking`

åˆ¤æ–­è¦ç‚¹ï¼š
- ç”¨æˆ·å·²è¯´å®Œä½†æ²¡æœ‰ `vad_end`ï¼šåç«¯ VAD æ ‡è®°æœªå‘ã€‚

### 5) å›ç­”ä¸­ï¼ˆtalkingï¼‰

è¿›å…¥ `talking` æœ‰ä¸¤æ¡è·¯ï¼š

- åç«¯ `audio_start` è§¦å‘æå‰åˆ‡æ¢  
  æ§åˆ¶å°ï¼š`â–¶ï¸ audio_start æå‰åˆ‡æ¢çŠ¶æ€ ... â†’ talking`
- LiveKit ç›‘å¬åˆ°è¿œç«¯ speaking=true è§¦å‘  
  æ§åˆ¶å°ï¼š`â–¶ï¸ è¿œç«¯ ... å¼€å§‹æ’­æ”¾éŸ³é¢‘ï¼Œä»thinkingåˆ‡æ¢åˆ°talking`


### 6) å†æ¬¡è†å¬ï¼ˆlisteningï¼‰

åç«¯å‘ `<state><generate_end>`ï¼ˆç”Ÿæˆç»“æŸï¼‰åï¼Œå‰ç«¯æ£€æµ‹éŸ³é¢‘ç»“æŸå¹¶å‘é€ `play_end`ï¼Œéšååç«¯å› `<state><play_end_success>`ï¼Œå‰ç«¯åˆ‡å› `listening`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `âœ… æ”¶åˆ° generate_endï¼Œæ ‡è®°ç”Ÿæˆç»“æŸ`
- `ğŸ”„ generate_end...ç­‰å¾… play_end_success`
- `âœ… æ”¶åˆ° play_end_successï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º listening`


## ä¸€å¥è¯åˆ¤æ–­æŒ‡å—

- **å‰ç«¯é—®é¢˜**ï¼šæ—¥å¿—é‡Œå·²ç»å‡ºç°â€œåˆ‡æ¢æˆåŠŸâ€ï¼Œä½† UI/çŠ¶æ€æ²¡å˜ã€‚
- **åç«¯é—®é¢˜**ï¼šå…³é”® `<state>` æ ‡è®°æ—¥å¿—ç¼ºå¤±ï¼ˆ`model_init_success`/`session_init`/`vad_end`/`audio_start`/`generate_end`/`play_end_success`ï¼‰ã€‚
# LiveKit çŠ¶æ€åˆ‡æ¢è¯´æ˜ï¼ˆæµ‹è¯•ç‰ˆï¼‰

é¢å‘æµ‹è¯•åŒå­¦ï¼šæŒ‰æ—¶é—´çº¿è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ï¼Œå¿«é€Ÿåˆ¤æ–­â€œå‰ç«¯çŠ¶æ€åˆ‡æ¢æœ‰è¯¯â€è¿˜æ˜¯â€œåç«¯æ ‡è®°é”™å‘/æ¼å‘â€ã€‚

## æ—¶é—´çº¿ï¼ˆæ¨¡å‹åˆå§‹åŒ– â†’ è¿æ¥ä¸­ â†’ è†å¬ä¸­ â†’ æ€è€ƒä¸­ â†’ å›ç­”ä¸­ â†’ å†æ¬¡è†å¬ï¼‰

### 1) æ¨¡å‹åˆå§‹åŒ–ï¼ˆinitializingï¼‰

å‰ç«¯è°ƒç”¨ `joinRoom()` åä¼šæŠŠçŠ¶æ€ç½®ä¸º `initializing`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `=== LiveKit è¿æ¥é…ç½® ===`ï¼ˆå‰ç«¯å¼€å§‹è¿æ¥ï¼‰
- `=== è¿æ¥æˆåŠŸçŠ¶æ€ ===` / `âœ… state.connected å·²è®¾ç½®ä¸º true`ï¼ˆè¿æ¥æˆåŠŸï¼‰
- `ğŸ‰ æ”¶åˆ°æ¨¡å‹åˆå§‹åŒ–æˆåŠŸä¿¡å·`ï¼ˆåç«¯è¿”å› `model_init_success`ï¼‰

åˆ¤æ–­è¦ç‚¹ï¼š
- åªæœ‰â€œè¿æ¥æˆåŠŸæ—¥å¿—â€è€Œæ²¡æœ‰â€œæ¨¡å‹åˆå§‹åŒ–æˆåŠŸâ€ï¼Œå¤šåŠæ˜¯åç«¯æœªå‘ `model_init_success`ã€‚
- è¿â€œè¿æ¥æˆåŠŸæ—¥å¿—â€éƒ½æ²¡æœ‰ï¼Œä¼˜å…ˆæ’æŸ¥å‰ç«¯è¿æ¥/ç½‘ç»œã€‚

### 2) è¿æ¥ä¸­ï¼ˆconnectingï¼‰

**å‰ç«¯æ²¡æœ‰æ˜ç¡®çš„ `connecting` çŠ¶æ€å€¼**ï¼Œä»…é æ—¥å¿—åˆ¤æ–­æ˜¯å¦è¿˜åœ¨è¿æ¥ã€‚

æ§åˆ¶å°è§‚å¯Ÿï¼š
- æœ‰ `Roomè¿æ¥çŠ¶æ€å˜åŒ–: reconnecting` è¡¨ç¤ºé‡è¿ä¸­
- æ²¡æœ‰ `è¿æ¥æˆåŠŸ` çš„æ—¥å¿—æ—¶ï¼Œå¯è§†ä¸ºâ€œè¿æ¥ä¸­â€

åˆ¤æ–­è¦ç‚¹ï¼š
- åå¤ `reconnecting`ï¼Œä¼˜å…ˆæ’æŸ¥ç½‘ç»œä¸æœåŠ¡ç«¯è¿æ¥ç¨³å®šæ€§ã€‚

### 3) è†å¬ä¸­ï¼ˆlisteningï¼‰

åç«¯å‘é€ `session_init` åï¼Œå‰ç«¯åˆ‡ä¸º `listening`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `ğŸ”„ æ”¶åˆ° session_initï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º listening`

åˆ¤æ–­è¦ç‚¹ï¼š
- å‰ç«¯å·²è¿æ¥æˆåŠŸä½†ä¸€ç›´æ²¡çœ‹åˆ° `session_init`ï¼Œä¸€èˆ¬æ˜¯åç«¯æœªå‘è¯¥æ ‡è®°ã€‚

### 4) æ€è€ƒä¸­ï¼ˆthinkingï¼‰

ç”¨æˆ·è¯´å®Œè¯åï¼Œåç«¯å‘ `vad_end`ï¼Œå‰ç«¯åˆ‡ä¸º `thinking`ã€‚

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `ğŸ¤” æ”¶åˆ° vad_endï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º thinking`

åˆ¤æ–­è¦ç‚¹ï¼š
- ç”¨æˆ·å·²è¯´å®Œï¼Œè¿Ÿè¿Ÿæ²¡æœ‰ `vad_end`ï¼Œä¸€èˆ¬æ˜¯åç«¯ VAD äº‹ä»¶æœªå‘ã€‚

### 5) å›ç­”ä¸­ï¼ˆtalkingï¼‰

è¿›å…¥ `talking` æœ‰ä¸¤æ¡è·¯ï¼š

- åç«¯ `audio_start` è§¦å‘å‰ç«¯æå‰åˆ‡æ¢  
  æ§åˆ¶å°ï¼š`â–¶ï¸ audio_start æå‰åˆ‡æ¢çŠ¶æ€ ... â†’ talking`
- LiveKit ç›‘å¬åˆ°è¿œç«¯ speaking=true åˆ‡æ¢  
  æ§åˆ¶å°ï¼š`â–¶ï¸ è¿œç«¯ ... å¼€å§‹æ’­æ”¾éŸ³é¢‘ï¼Œä»thinkingåˆ‡æ¢åˆ°talking`

åˆ¤æ–­è¦ç‚¹ï¼š
- æ”¶åˆ° `audio_start` ä½†æ²¡æœ‰è¿›å…¥ `talking`ï¼Œåå‘å‰ç«¯çŠ¶æ€åˆ‡æ¢é—®é¢˜ã€‚
- æ²¡æœ‰ `audio_start` ä¹Ÿæ²¡æœ‰ speaking=trueï¼Œåå‘åç«¯æœªå‘éŸ³é¢‘æˆ–æµæœªåˆ°å‰ç«¯ã€‚

### 6) å›åˆ°è†å¬ï¼ˆlisteningï¼‰

è¿™æ˜¯â€œå‰ç«¯è§¦å‘ + åç«¯ç¡®è®¤â€çš„ç»„åˆæµç¨‹ï¼š

1. åç«¯å‘ `generate_end`ï¼ˆç”Ÿæˆç»“æŸï¼‰
2. å‰ç«¯é™é»˜æ£€æµ‹åå‘é€ `play_end`
3. åç«¯å› `play_end_success`ï¼Œå‰ç«¯åˆ‡å› `listening`

æ§åˆ¶å°åº”çœ‹åˆ°ï¼š
- `âœ… æ”¶åˆ° generate_endï¼Œæ ‡è®°ç”Ÿæˆç»“æŸ`
- `ğŸ”„ generate_end...ç­‰å¾… play_end_success`
- `âœ… æ”¶åˆ° play_end_successï¼ŒçŠ¶æ€åˆ‡æ¢ä¸º listening`

åˆ¤æ–­è¦ç‚¹ï¼š
- æœ‰ `generate_end` ä½†ä¸€ç›´æ²¡æœ‰ `play_end_success`ï¼Œä¼˜å…ˆæ€€ç–‘åç«¯æœªç¡®è®¤ã€‚
- é¢‘ç¹å‡ºç° `ç­‰å¾… play_end_success` ä½†çŠ¶æ€ä¸å› `listening`ï¼Œä¼˜å…ˆæŸ¥åç«¯æ˜¯å¦æ¼å‘ã€‚

## ä¸€å¥è¯åˆ¤æ–­æŒ‡å—

- **å‰ç«¯é—®é¢˜**ï¼šæ—¥å¿—é‡Œå·²ç»å‡ºç°â€œåˆ‡æ¢æˆåŠŸâ€å­—æ ·ï¼Œä½† UI/çŠ¶æ€æ²¡å˜ã€‚
- **åç«¯é—®é¢˜**ï¼šå…³é”® `<state>` æ ‡è®°æ—¥å¿—ç¼ºå¤±ï¼ˆ`model_init_success`/`session_init`/`vad_end`/`audio_start`/`generate_end`/`play_end_success`ï¼‰ã€‚
# LiveKit çŠ¶æ€åˆ‡æ¢è¯´æ˜ï¼ˆå‰ç«¯ï¼‰

æœ¬æ–‡åŸºäº `src/hooks/useLiveKit.js`ï¼Œç”¨äºè¯´æ˜å‰ç«¯çŠ¶æ€æœºçš„åˆ‡æ¢æ¡ä»¶ã€è§¦å‘æ¥æºä»¥åŠå‰åç«¯ä¾èµ–å…³ç³»ã€‚

## çŠ¶æ€å®šä¹‰

- `''`ï¼šç©ºé—²/æœªè¿æ¥ï¼ˆé»˜è®¤æˆ–ç¦»å¼€åï¼‰
- `initializing`ï¼šç­‰å¾…æ¨¡å‹åˆå§‹åŒ–/ä¼šè¯åˆå§‹åŒ–
- `init_failed`ï¼šæ¨¡å‹åˆå§‹åŒ–å¤±è´¥
- `listening`ï¼šå¾…ç”¨æˆ·è¯´è¯/ç©ºé—²å¯è¾“å…¥
- `thinking`ï¼šVAD ç»“æŸåï¼Œæ¨¡å‹æ€è€ƒ/ç”Ÿæˆä¸­
- `talking`ï¼šæ¨¡å‹éŸ³é¢‘æ’­æ”¾ä¸­
- `forbidden`ï¼šå®‰å®¡å‘½ä¸­
- `robot_exit`ï¼šæœºå™¨äººé€€å‡º
- `connecting`ï¼šå†å²é—ç•™å ä½ï¼Œä¸ä¼šè¢«çœŸæ­£è®¾ç½®ï¼ˆä»…åœ¨å®¹é”™é€»è¾‘ä¸­å‡ºç°ï¼‰

## çŠ¶æ€åˆ‡æ¢æ€»è§ˆï¼ˆæŒ‰è§¦å‘æºï¼‰

### å‰ç«¯è§¦å‘ï¼ˆæœ¬åœ°é€»è¾‘/LiveKit äº‹ä»¶/DOM æ£€æµ‹ï¼‰

- `'' â†’ initializing`ï¼šè°ƒç”¨ `joinRoom()` æ—¶å‰ç«¯ç›´æ¥ç½®ä¸ºåˆå§‹åŒ–
- `thinking/listening/initializing/'' â†’ talking`ï¼šå‰ç«¯æ£€æµ‹åˆ°è¿œç«¯ speaking=trueï¼Œæˆ–æ”¶åˆ° `audio_start` åçš„å®¹é”™åˆ‡æ¢
- `talking â†’ listening`ï¼šå‰ç«¯æ£€æµ‹éŸ³é¢‘æ’­æ”¾ç»“æŸå¹¶å‘é€ `play_end`ï¼Œä½†æœ€ç»ˆåˆ‡æ¢éœ€åç«¯ç¡®è®¤
- `* â†’ listening`ï¼šæ”¶åˆ°åç«¯ `session_break` åï¼Œå‰ç«¯æ‰§è¡Œæ‰“æ–­é€»è¾‘
- `* â†’ ''`ï¼š`leaveRoom()` æ¸…ç†åå›åˆ°ç©ºé—²

### åç«¯ä¿¡å·è§¦å‘ï¼ˆDataChannel/ChatMessageï¼‰

- `initializing â†’ init_failed`ï¼š`<state><model_init_failed>`
- `initializing â†’ listening`ï¼š`<state><session_init>`ï¼ˆé¦–æ¬¡æœ‰æ•ˆï¼‰
- `listening â†’ thinking`ï¼š`<state><vad_end>`
- `thinking/initializing/'' â†’ talking`ï¼š`<state><audio_start>`ï¼ˆæå‰åˆ‡æ¢ï¼‰
- `talking â†’ listening`ï¼š`<state><play_end_success>`ï¼ˆå‰ç«¯å·²å‘é€ play_end åç¡®è®¤ï¼‰
- `* â†’ forbidden`ï¼š`<state><audit_stop>`
- `* â†’ robot_exit`ï¼š`<state><robot_exit>`
- `* â†’ listening`ï¼š`<state><session_break>`ï¼ˆæ‰“æ–­æˆåŠŸä¿¡å·ï¼‰

## å…³é”®æµç¨‹è¯¦è¿°

### 1) åˆå§‹åŒ–ä¸ä¼šè¯å°±ç»ª

1. å‰ç«¯è°ƒç”¨ `joinRoom()` åï¼Œç«‹å³è¿›å…¥ `initializing`
2. åç«¯å› `model_init_success` åä»ä¿æŒ `initializing`ï¼Œç”¨äºå‘é€ initConfig
3. åç«¯å› `session_init` åï¼Œå‰ç«¯åˆ‡åˆ° `listening`ï¼ˆåªç”Ÿæ•ˆä¸€æ¬¡ï¼‰
4. è‹¥åç«¯å› `model_init_failed`ï¼Œå‰ç«¯è¿›å…¥ `init_failed`

ä¾èµ–å…³ç³»ï¼š
- `initializing â†’ listening`ã€`init_failed` å®Œå…¨ä¾èµ–åç«¯ä¿¡å·
- `initializing` çš„è¿›å…¥ç”±å‰ç«¯è§¦å‘

### 2) ç”¨æˆ·è¯´è¯ç»“æŸ â†’ æ¨¡å‹æ€è€ƒ

1. åç«¯æ£€æµ‹åˆ° VAD ç»“æŸï¼Œå‘ `vad_end`
2. å‰ç«¯æ”¶åˆ°ååˆ‡åˆ° `thinking`

ä¾èµ–å…³ç³»ï¼š
- `listening â†’ thinking` ä¾èµ–åç«¯ä¿¡å·

### 3) æ¨¡å‹æ’­æ”¾å¼€å§‹ï¼ˆè¿›å…¥ talkingï¼‰

è§¦å‘æ¥æºæœ‰ä¸¤ç§ï¼š

- **åç«¯ä¿¡å·**ï¼š`audio_start` ä¼šè®©å‰ç«¯æå‰åˆ‡ `talking`
- **å‰ç«¯æ£€æµ‹**ï¼šLiveKit `IsSpeakingChanged` ç›‘å¬åˆ° speaking=true ä¹Ÿä¼šåˆ‡ `talking`

ä¾èµ–å…³ç³»ï¼š
- `thinking/initializing/'' â†’ talking` å¯ç”±å‰ç«¯æˆ–åç«¯è§¦å‘

### 4) æ¨¡å‹æ’­æ”¾ç»“æŸï¼ˆå›åˆ° listeningï¼‰

è¿™æ˜¯â€œå‰ç«¯è§¦å‘ + åç«¯ç¡®è®¤â€çš„ç»„åˆæµç¨‹ï¼š

1. åç«¯å‘ `generate_end`ï¼ˆç”Ÿæˆç»“æŸï¼‰
2. å‰ç«¯è¿›è¡Œé™é»˜æ£€æµ‹ï¼ˆè¿œç«¯è¯´è¯çŠ¶æ€ + DOM éŸ³é¢‘æ’­æ”¾çŠ¶æ€ï¼‰
3. è‹¥åˆ¤æ–­éŸ³é¢‘å·²ç»“æŸï¼Œå‰ç«¯å‘é€ `play_end`
4. åç«¯å› `play_end_success`ï¼Œå‰ç«¯æ‰çœŸæ­£åˆ‡æ¢åˆ° `listening`

ä¾èµ–å…³ç³»ï¼š
- è§¦å‘æ£€æŸ¥ä¾èµ–åç«¯ `generate_end`
- çŠ¶æ€åˆ‡æ¢ä¾èµ–åç«¯ `play_end_success`
- é™é»˜åˆ¤æ–­é€»è¾‘ä¾èµ–å‰ç«¯æœ¬åœ°çŠ¶æ€ä¸ DOM

### 5) æ‰“æ–­æµç¨‹

1. å‰ç«¯å‘é€æ‰“æ–­æŒ‡ä»¤ï¼ˆDataChannelï¼‰
2. åç«¯å› `session_break`
3. å‰ç«¯ç«‹å³åˆ‡ `listening`ï¼Œå¹¶é™éŸ³è¿œç«¯éŸ³é¢‘

ä¾èµ–å…³ç³»ï¼š
- çŠ¶æ€åˆ‡æ¢ç”±åç«¯ `session_break` è§¦å‘
- å®é™…é™éŸ³ä¸ UI åˆ‡æ¢ç”±å‰ç«¯æ‰§è¡Œ

### 6) å®‰å®¡ä¸æœºå™¨äººé€€å‡º

åç«¯ä¿¡å·ç›´æ¥åˆ‡æ¢ï¼š

- `audit_stop â†’ forbidden`
- `robot_exit â†’ robot_exit`

## ä¾èµ–å…³ç³»é€ŸæŸ¥è¡¨

### ä¾èµ–åç«¯ä¿¡å·

- `initializing â†’ init_failed`ï¼š`model_init_failed`
- `initializing â†’ listening`ï¼š`session_init`
- `listening â†’ thinking`ï¼š`vad_end`
- `* â†’ talking`ï¼š`audio_start`ï¼ˆæå‰åˆ‡ï¼‰
- `talking â†’ listening`ï¼š`play_end_success`
- `* â†’ forbidden`ï¼š`audit_stop`
- `* â†’ robot_exit`ï¼š`robot_exit`
- `* â†’ listening`ï¼š`session_break`

### ä¾èµ–å‰ç«¯é€»è¾‘/äº‹ä»¶

- `'' â†’ initializing`ï¼š`joinRoom()` / `setInitConfig()`
- `thinking/listening/initializing/'' â†’ talking`ï¼šLiveKit speaking=true
- `talking â†’ listening`ï¼šé™é»˜æ£€æµ‹ + å‘é€ `play_end`ï¼ˆä½†ç¡®è®¤éœ€åç«¯ï¼‰
- `* â†’ ''`ï¼š`leaveRoom()`

## å¤‡æ³¨

- `connecting` ä»…åœ¨å®¹é”™åˆ¤æ–­ä¸­å‡ºç°ï¼Œå®é™…ä¸ä¼šè¢«èµ‹å€¼æˆå½“å‰çŠ¶æ€
- `play_end` æ˜¯å‰ç«¯å‘é€çš„ç»“æŸè¯·æ±‚ï¼Œåªæœ‰åç«¯è¿”å› `play_end_success` æ‰çœŸæ­£åˆ‡æ¢ä¸º `listening`
